<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CODE. 졸업전시</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Google Font (Noto Sans KR) for Main Content -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN for Intro -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- GSAP CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <!-- p5.js 라이브러리 임포트 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <!-- 외부 CSS 파일 연결 -->
    <link rel="stylesheet" href="gnb.css">
    <link rel="stylesheet" href="style.css">
    <style>

    </style>
  </head>
  <body>
    <!-- Intro Animation Container -->
    <div id="intro-container" class="relative w-full h-screen overflow-hidden">
      <!-- Top Panel (Z-index: 20) -->
      <div id="panelTop" class="absolute top-0 left-0 w-full h-1/2 bg-teal-500 z-20 overflow-hidden">
        <!-- 1단계 텍스트를 감싸는 div (절대 위치) -->
        <div class="absolute top-0 left-0 p-10 md:p-16">
          <!-- 1단계 텍스트 요소 -->
          <span id="text1" class="block text-3xl md:text-5xl font-bold text-white mb-3">2025 졸업전시에</span>
          <span id="text2" class="block text-3xl md:text-5xl font-bold text-white">당신을 초대합니다</span>
        </div>
      </div>

      <!-- 2단계 텍스트 컨테이너 (z-40) -->
      <div id="textContainer" class="absolute top-0 left-0 w-full h-1/2 z-40 flex items-end justify-center pb-8 pointer-events-none">
        <div class="flex items-center space-x-4 text-2xl font-bold">
          <span id="codeText" class="text-white">CODE</span>
          <span id="slashText" class="text-gray-200">/</span>
          <span id="projectText" class="text-white">PROJECT</span>
        </div>
      </div>

      <!-- Bottom Panel (Z-index: 20) -->
      <div id="panelBottom" class="absolute bottom-0 left-0 w-full h-1/2 bg-teal-500 z-20 flex items-end justify-center pb-4">
        <div id="loadingPercentage" class="text-sm font-mono text-white/50">(0%)</div>
      </div>

      <!-- 로딩 바 컨테이너 (Z-index: 30) -->
      <div id="loadingContainer" class="absolute top-1/2 left-0 w-full z-30">
        <div class="h-[1px] w-full bg-black/20"></div>
        <div id="loadingBar" class="absolute top-0 left-0 h-[1px] w-full bg-white"></div>
      </div>
    </div>

    <!-- Main Content (Initially hidden) -->
    <div id="main-content" style="display: none;">
      <!-- GNB가 삽입될 위치 -->
      <div id="gnb-placeholder"></div>

      <!-- 스크롤되는 콘텐츠 영역 -->
      <main>
        <!-- 각 섹션이 화면 전체를 차지하도록 하는 컨테이너 -->
        <section id="canvas-container">
          <!-- sketch.js가 이 안에 캔버스를 생성할 것입니다. -->
        </section>

        <section class="container" id="about">
          <h2>ABOUT</h2>
          <!-- GSAP 스크롤 애니메이션을 위한 구조 -->
          <div class="animation-wrapper">
            <div class="about-images-wrapper">
              <img class="scroll-image" src="about/poster.png" alt="Poster Image">

            </div>
            <!-- [수정] 텍스트 콘텐츠를 하나의 div로 그룹화 -->
            <div class="fade-in-text about-text">
              <!-- "Decoding/Encoding" 텍스트 블록 -->
              <div class="about-extra-text">
                <div>
                  <h3>Decoding</h3>
                  <p>세상을 읽고</p>
                </div>
                <div>
                  <h3>Encoding</h3>
                  <p>시각으로 답하다</p>
                </div>
              </div>
              <!-- 설명 문단 -->
              <div>
                <p>세상은 수많은 이야기와 정보, 그리고 보이지 않는 문제들로 가득 찬 거대한 텍스트입니다. 저희는 그 텍스트를 읽고, 해석하고, 우리만의 언어로 새로운 의미를 만들어내는 사람들, 바로 시각 디자이너입니다.</p>
                <p style="margin-top: 1.5em;">이번 졸업 작품은 ‘세상을 그리는 방식’에 대한 저희의 대답입니다.<br>이는 단순히 아름다운 것을 만드는 행위를 넘어, 복잡한 세상을 이해하고 그 문제에 대한 해결책을 시각적으로 제안하는 과정에 대한 이야기입니다.</p>
              </div>
            </div>
          </div>
        </section>

        <section class="container" id="info">
          <h2>INFO</h2>
          <!-- INFO Content (from info.html) -->
          <!-- [수정] 불필요한 div를 제거하고 info-list-container를 섹션의 자식으로 만듭니다. -->
          <div id="info-details" class="info-list-container">
            <!-- 첫 번째 섹션: 졸업전시위원 -->
            <section class="info-section">
                <h3 class="info-title">졸업전시위원</h3>
                <div class="info-member-list">
                    <p>김혜민</p> <p>박성욱</p> <p>박소현</p> <p>윤해주</p>
                </div>
            </section>

            <!-- 두 번째 섹션: 파트별 명단 -->
            <section class="info-section">
                <div class="info-grid">
                    <!-- 웹 파트 -->
                    <div class="info-list-item">
                        <h3 class="info-title">웹</h3>
                        <div class="info-member-list">
                            <p>강민진</p> <p>박송희</p> <p>박시은</p> <p>장서연</p> <p>장영웅</p>
                        </div>
                    </div>
                    <!-- 소형배너 파트 -->
                    <div class="info-list-item">
                        <h3 class="info-title">소형배너</h3>
                        <div class="info-member-list">
                            <p>서유정</p> <p>송예준</p> <p>이민준</p>
                        </div>
                    </div>
                    <!-- 대형배너 파트 -->
                    <div class="info-list-item">
                        <h3 class="info-title">대형배너</h3>
                        <div class="info-member-list">
                            <p>권한별</p> <p>조예빈</p>
                        </div>
                    </div>
                    <!-- 영상 파트 -->
                    <div class="info-list-item">
                        <h3 class="info-title">영상</h3>
                        <div class="info-member-list">
                            <p>고영인</p> <p>박성민</p> <p>이상훈</p>
                        </div>
                    </div>
                </div>
            </section>
          </div>
        </section>
      </main>
    </div>

    <!-- 외부 JS 파일 연결 -->
    <script src="intro.js"></script>
    <script src="sketch.js"></script>

    <script>
      // GNB를 동적으로 로드하고 현재 페이지에 'active' 클래스를 추가하는 스크립트
      document.addEventListener("DOMContentLoaded", function() {
        // 페이지 로드 시 스크롤을 최상단으로 강제 이동
        // [수정] CSS 대신 JS에서 스크롤을 제어합니다.
        document.body.style.overflow = 'hidden';
        window.scrollTo(0, 0);

        // [수정] 새로고침 시 스크롤 위치 복원 방지 및 강제 상단 이동
        if (history.scrollRestoration) {
          history.scrollRestoration = 'manual';
        }
        window.onbeforeunload = function () {
            window.scrollTo(0, 0);
        };

        fetch("gnb.html")
          .then(response => response.text())
          .then(data => {
            document.getElementById("gnb-placeholder").innerHTML = data;
            
            // 현재 페이지 URL을 기반으로 활성 링크 설정
            const currentPage = window.location.pathname.split("/").pop();
            const navLinks = document.querySelectorAll(".gnb-right a");
            navLinks.forEach(link => {
              if (link.getAttribute("href") === currentPage) {
                link.classList.add("active");
              }
            });

            // [수정] GNB 스크롤 이벤트를 다시 추가합니다.
            const gnb = document.querySelector('.gnb');
            if (gnb) {
              window.addEventListener('scroll', () => {
                // 10px 이상 스크롤되면 'scrolled' 클래스를 추가합니다.
                if (window.scrollY > 10) {
                  gnb.classList.add('scrolled');
                } else {
                  gnb.classList.remove('scrolled');
                }
              });
            }
          });

        // ABOUT 섹션 GSAP 스크롤 애니메이션
        // GSAP에 ScrollTrigger 플러그인 등록
        gsap.registerPlugin(ScrollTrigger);

        // [수정] ABOUT 섹션 펼침 효과 애니메이션
        let tl = gsap.timeline({
            scrollTrigger: {
                trigger: "#about", // ABOUT 섹션을 기준으로
                start: "top top", 
                end: "+=3000px", // [수정] 애니메이션 길이를 3000px로 늘려 INFO 섹션과 겹치지 않도록 함
                pin: true, // #about 섹션 전체를 고정 (true는 trigger 요소를 고정하라는 의미)
                scrub: 1, // 스크롤과 애니메이션을 부드럽게 동기화
                // markers: true, // 디버깅용 마커 (필요시 주석 해제)
                // [수정] 스크롤 트리거 영역에 들어올 때만 #about 섹션을 보이게 처리
                onEnter: () => gsap.to("#about", {visibility: 'visible'}),
                onLeaveBack: () => gsap.to("#about", {visibility: 'hidden'})
            }
        });

        // 1단계: "얇은 세로선" -> "긴 세로선" (세로로 길어짐)
        tl.to(".animation-wrapper", {
            height: "80vh",
            ease: "none"
        })
        // 2단계: "긴 세로선" -> "펼쳐진 상자" (가로로 넓어짐)
        .to(".animation-wrapper", {
            width: "100%",
            backgroundColor: "transparent", // 펼쳐진 후 배경색 투명하게
            overflow: "visible", // 펼쳐진 후 내부 콘텐츠가 보이도록 설정
            ease: "power1.inOut"
        })
        // 3단계: 이미지와 텍스트 나타나기
        .to([".scroll-image", ".fade-in-text"], {
            opacity: 1,
            stagger: 0.2, // 이미지, 텍스트 순으로 0.2초 간격으로 나타남
            ease: "power1.inOut"
        }, "-=0.5"); // 2단계 애니메이션이 끝나기 0.5초 전에 시작

        // [수정] 모든 ScrollTrigger 인스턴스를 새로고침하여 위치를 재계산합니다.
        ScrollTrigger.refresh();
      });
    </script>
  </body>
</html>